[?1034h<?xml version="1.0" ?>
<cib admin_epoch="0" cib-last-written="Thu Oct 20 16:24:21 2011" crm_feature_set="3.0.5" dc-uuid="mamba13" epoch="30" have-quorum="1" num_updates="73" update-client="crm_resource" update-origin="mamba13" validate-with="pacemaker-1.2">
  <configuration>
    <crm_config>
      <cluster_property_set id="cib-bootstrap-options">
        <nvpair id="cib-bootstrap-options-dc-version" name="dc-version" value="1.1.6-1.fc14-b379478e0a66af52708f56d0302f50b6f13322bd"/>
        <nvpair id="cib-bootstrap-options-cluster-infrastructure" name="cluster-infrastructure" value="openais"/>
        <nvpair id="cib-bootstrap-options-expected-quorum-votes" name="expected-quorum-votes" value="2"/>
        <nvpair id="cib-bootstrap-options-no-quorum-policy" name="no-quorum-policy" value="ignore"/>
      </cluster_property_set>
    </crm_config>
    <nodes>
      <node id="mamba13" type="normal" uname="mamba13"/>
      <node id="mamba14" type="normal" uname="mamba14"/>
    </nodes>
    <resources>
      <master id="UlrDataClone">
        <meta_attributes id="UlrDataClone-meta_attributes">
          <nvpair id="UlrDataClone-meta_attributes-master-max" name="master-max" value="1"/>
          <nvpair id="UlrDataClone-meta_attributes-master-node-max" name="master-node-max" value="1"/>
          <nvpair id="UlrDataClone-meta_attributes-clone-max" name="clone-max" value="2"/>
          <nvpair id="UlrDataClone-meta_attributes-clone-node-max" name="clone-node-max" value="1"/>
          <nvpair id="UlrDataClone-meta_attributes-notify" name="notify" value="true"/>
        </meta_attributes>
        <primitive class="ocf" id="UlrData" provider="linbit" type="drbd">
          <instance_attributes id="UlrData-instance_attributes">
            <nvpair id="UlrData-instance_attributes-drbd_resource" name="drbd_resource" value="ulr-data"/>
          </instance_attributes>
          <operations>
            <op id="UlrData-monitor-30s" interval="30s" name="monitor"/>
          </operations>
        </primitive>
      </master>
      <primitive class="ocf" id="ClusterIP" provider="heartbeat" type="IPaddr2">
        <instance_attributes id="ClusterIP-instance_attributes">
          <nvpair id="ClusterIP-instance_attributes-ip" name="ip" value="10.192.10.50"/>
          <nvpair id="ClusterIP-instance_attributes-cidr_netmask" name="cidr_netmask" value="24"/>
        </instance_attributes>
        <operations>
          <op id="ClusterIP-monitor-5s" interval="5s" name="monitor"/>
        </operations>
      </primitive>
      <primitive class="ocf" id="FS" provider="heartbeat" type="Filesystem">
        <instance_attributes id="FS-instance_attributes">
          <nvpair id="FS-instance_attributes-device" name="device" value="/dev/drbd/by-res/ulr-data"/>
          <nvpair id="FS-instance_attributes-directory" name="directory" value="/var/cluster"/>
          <nvpair id="FS-instance_attributes-fstype" name="fstype" value="ext4"/>
        </instance_attributes>
      </primitive>
      <primitive class="ocf" id="WebApp" provider="heartbeat" type="apache">
        <instance_attributes id="WebApp-instance_attributes">
          <nvpair id="WebApp-instance_attributes-configfile" name="configfile" value="/etc/httpd/conf/httpd.conf"/>
        </instance_attributes>
        <operations>
          <op id="WebApp-monitor-10s" interval="10s" name="monitor"/>
        </operations>
      </primitive>
    </resources>
    <constraints>
      <rsc_location id="cli-prefer-ClusterIP" rsc="ClusterIP">
        <rule id="cli-prefer-rule-ClusterIP" score="INFINITY">
          <expression attribute="#uname" id="cli-prefer-expr-ClusterIP" operation="eq" value="mamba14"/>
        </rule>
      </rsc_location>
      <rsc_colocation id="WebApp-with-FS" rsc="WebApp" score="INFINITY" with-rsc="FS"/>
      <rsc_order first="UlrDataClone" first-action="promote" id="FS-after-UlrData" score="INFINITY" then="FS" then-action="start"/>
      <rsc_colocation id="fs_on_drbd" rsc="FS" score="INFINITY" with-rsc="UlrDataClone" with-rsc-role="Master"/>
      <rsc_order first="ClusterIP" id="apache-after-ip" score="INFINITY" then="WebApp"/>
      <rsc_colocation id="ulr-acg-project" rsc="WebApp" score="INFINITY" with-rsc="ClusterIP"/>
      <rsc_order first="FS" id="WebApp-after-FS" score="INFINITY" then="WebApp"/>
    </constraints>
  </configuration>
</cib>

